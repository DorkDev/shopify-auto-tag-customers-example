#!/usr/bin/env node
'use strict';

//module dependencies.
var api = require('../dist/api');
var debug = require('debug')('scripts:subscribe');
var config = require('../config');
var storeAuth = 'https://' + config.api_key + ':' + config.password + '@' + config.store + '.myshopify.com';
var argv = require('minimist')(process.argv.slice(2));

debug('argv %s', argv);
debug('storeAuth %s', storeAuth);

if (argv.topic && argv.address) {
  api.subscribeToWebhook(storeAuth, argv.topic, argv.address);
} else {
  if (!argv.topic) {
    throw new Error('topic is missing');
  }
  
  if (!argv.address) {
    throw new Error('address is missing');
  }
}

// npm run subscribe -- --topic "orders/create" --address "http://277aa1c4.ngrok.io"
